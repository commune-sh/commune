<script>
import '../../app.css'
import { page } from '$app/stores';
let { data, children } = $props()
import Logo from '$lib/logo/logo.svelte'
import { onMount } from 'svelte'
import { goto } from '$app/navigation'

import Listeners from '$lib/listeners/listeners.svelte'
import HomeserverDown from '$lib/alert/homeserver-down.svelte'

import { createStore } from '$lib/store/store.svelte.js'
const store = createStore()


const authenticated = $derived(store.auth.authenticated)

const login_token = $derived($page.url.searchParams.get('loginToken'))

onMount(() => {
    if(!login_token) {
        store.matrix.getFlows()
    }
})

$effect(() => {
    if(authenticated) {
        goto('/')
    }
})

</script>

<Listeners />

<HomeserverDown />


<div class="mt-mid flex flex-col h-full items-center select-none">
    <div class="mb-4">
        <Logo is_static={true} />
    </div>
    <div class="flex flex-col max-w-[26rem] w-full px-5">
        {@render children()}
    </div>
</div>

<style>
</style>
